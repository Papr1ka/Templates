# Templates

## Зависимости
Для автогенерации отчётов понадобятся последние версии следующих утилит

- [pandoc](https://github.com/jgm/pandoc/releases)
- [pandoc-crossref](https://github.com/lierdakil/pandoc-crossref/releases)

> Примечание:
Для работы программы необходимо, чтобы в переменной окружения Path был путь до директории, в которой содержатся исполняемые файлы pandoc.exe и pandoc-crossref.exe

> Pandoc предлагается устанавливать установщиком (По умолчанию будет выбран путь - C:\Users\User\AppData\Local\Pandoc)
> 
> В полученную папку необходимо добавить исполняемый файл фильтра - pandoc-crossref.exe
>
> В итоге, в переменной окружения Path должен быть путь (C:\Users\User\AppData\Local\Pandoc) (если была выбрана директория по умолчанию)

## Структура
- templates/ - готовые шаблоны отчётов о практических работах
- base.docx - шаблон файла .docx со всеми стилями и титульным листом
- start.bat - команда запуска для windows
- build.ps1 - скрипт на powershell, доделывающий работы за pandoc
- linebreaks.lua - фильтр для pandoc

## Использование
1. Клонирование репозитория

	git clone https://github.com/Papr1ka/Templates

2. Копирование нужного шаблона из папки templates в папку input
3. Загрузка в папку input необходимых картинок, указанных в шаблоне
4. Изменение start.bat с указанием нужного номера шаблона (practice[1-8])
5. Запуск start.bat
6. Изменение в получившемся отчёте полей титульника (Фамилия И.О., номер работы, тема работы) (подсвечены красным)
7. Дальнейшее распоряжение отчётом (output/output.docx и output/output.pdf)

## Правила оформления отчёта

[Правила](./decor.md)

[Конструктор](./template.md)

## Настройка удобного рабочего окружения

На данный момент предпочтительно использовать vscode, потому что в нем есть предварительный просмотр, а также сниппеты

В этой директории имеется папка pandoc-docx-snippets - это расширение для vscode

Если ваша OS - Linux, то просто запустите скрипт `setupvscode.so`, он также в этой директории

Иначе про установку и использование написано в следующем файле

[Про сниппеты написано в этом файле](/pandoc-docx-snippets/README.md)

Также предлагается попробовать использовать пандок без скрипта с вордом, возможно результат будет для вас преемлимым

Предлагается скрипт `convert.so` для работы чистого pandoc, работает очень быстро по сравнению с вордом